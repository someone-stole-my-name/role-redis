{% if ansible_hostname != redis_initial_master %}
slaveof {{ redis_initial_master_ip }} {{ redis_port }}
{% endif %}
bind {{ redis_bind_addr }}
protected-mode yes
supervised systemd
dir {{ redis_data_dir }}

{% if redis_tls %}
tls-port {{ redis_port }}
port 0
tls-auth-clients yes
tls-ca-cert-file {{ redis_config_dir }}/tls_ca.crt
tls-key-file {{ redis_config_dir }}/tls_key.key
tls-cert-file {{ redis_config_dir }}/tls_cert.crt
tls-replication yes
{% else %}
port {{ redis_port }}
{% endif %}
